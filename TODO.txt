NEXT
----

- standardize on "id" or "pk"

- add return_code and description to HeartBeat

- inline editable cron_spec and url_to_monitor


- pull "cron_spec" from api calls
    - allow r'^(\d+)([hmsdw])$' -> 24h, 1h, 30m, 180s, 7d

- worker should send emails when we seem to be missing something

- login with username/password in master configfile
    - every endpoint except "heartbeat_api" should be forced to be authed
    - OR accept any signed requests? Would need to include "_path" key in signature
      and maybe a "_method" along with "_nonce".

      def sign(data, path=None, method='POST'):
            data = dict(data)
            data['_path'] = request.path_info if path is None else path
            data['_method'] = method
            return hmac(key, '&'.join('%s=%s' % x for x in sorted(data.iteritems())))

    @sig_includes('name') decorator to specify that the other parameters can
     vary

- sign the `curl` URLs
    - for now can just include a v=1 along with a nonce, and sign that
    - can ban nonces in the future if they are problematic


IDEAS
-----
- form for specifying service name, machine it runs on, how often it is
  expected to check in, etc.
- creates a curl command to put at the end of periodic scripts

    curl 
        -A "heartbeat/$(hostname)" \
        -F "name=mendel.mikeboers.com backup" \
        -F "job=filesystem rsync" \
        -F "period=24h" \
        -F "allow=mendel.mikeboers.com" \
        -F "nonce=0123456789abcdef" \
        -F "signature=0123456789abcdef" \
        http://heartbeat.mikeboers.com/api/beat

- return_code is special and flags that it failed if != 0
- anything extra POSTed is remembered and displayed to the user

- what fields are required:
    name
    subname (allows for several things to contribute to one "job"; optional)
    period (how often we expect to see this; in minutes)
    allow (ips or hostnames to allow from; allows pattern matching; optional)
    nonce
    signature (hmac of urlencode(sorted(data.iteritems())) with secret_key)
