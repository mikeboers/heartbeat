<!doctype html>
<head>
    <title>{{ request.host }}</title>
    <link href="//netdna.bootstrapcdn.com/twitter-bootstrap/2.3.1/css/bootstrap-combined.min.css" rel="stylesheet">

<body>
<div class="container">

<div class="row">

    <h1>{{ request.host }}</h1>

    {% if config.get('SQLALCHEMY_DATABASE_URI')  == 'sqlite://' %}
        <div class="alert">
          <button type="button" class="close" data-dismiss="alert">&times;</button>
          <strong>Warning!</strong> This instance is using the testing database; your data is not permanent.
        </div>
    {% endif %}

    {% for service in services %}
    <hr />
    <h2>{{ service.name }}</h2>

    <table class="table table-striped table-hover">
        <thead><tr>
            <td><!-- status -->
            <td>Name
            <td>Last Time
            <td>Last Origin
            <td>Actions
        <tbody>
        {% for component in service.components %}
        <tr>
            <td>
                <!-- TODO: add some logic here -->
                <span class="label label-success">ok</span>
            <td><strong>{{ component.name }}</strong><br />
                <small>{{ component.heartbeats | length }} beats</small>
            <td>{{ component.heartbeats[0].time | timedeltaformat }}<br/>
                <small>{{ component.heartbeats[0].time | datetimeformat('d MMMM, yyyy h:mm:ss a z') }}</small>
            <td>{{ component.heartbeats[0].remote_name }}<br/>
                <small>{{ component.heartbeats[0].remote_addr }}</small>
            <td>
                <a class="btn btn-mini btn-danger" disabled><i class="icon-trash icon-white"></i> Delete</a>

        {% endfor %}

    </table>
    {% endfor %}




    <h3>Script Integration</h3>
    <p>Copy the following command into the end of your script to create
       a heartbeat here.
    </p>
    <input id="curl" class="input-block-level" type="text" value='curl -F"service=example" -F"name=$(hostname)" {{ request.url_root }}api/beat' />

    <script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
    <script src="//netdna.bootstrapcdn.com/twitter-bootstrap/2.3.1/js/bootstrap.min.js"></script>
    <script>
        $("#curl").click(function() {
           $(this).select();
        });
    </script>
